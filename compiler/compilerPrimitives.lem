open Ast
open SemanticPrimitives
open CompilerLib

let rec
map_result f (Rval v) = Rval (f v)
and
map_result f (Rerr e) = Rerr e

let rec
every_result  P (Rerr _) = true
and
every_result P (Rval v) = P v

let rec
error_to_int Bind_error = i0
and
error_to_int Div_error = i1
and
error_to_int (Int_error n) = Int.(+) i2 n

let rec
num_to_bool 0 = false
and
num_to_bool 1 = true

